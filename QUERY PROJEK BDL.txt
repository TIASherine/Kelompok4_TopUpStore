QUERY PROJEK BDL

VIEW:

CREATE VIEW TRANSAKSI_USER AS
SELECT 
P.ID_PEMBELI AS UID,
P.USERNAME,
A.NAMA_AKUN AS AKUN,
TR.PRODUK_TRANSAKSI AS PEMBELIAN,
TR. HARGA,
TR.METODE_PEMBAYARAN,
TR.WAKTU_TR AS TANGGAL,
TR.STATUS
FROM TRANSAKSI TR JOIN PEMBELI P 
ON TR.ID_PEMBELI_TR = P.ID_PEMBELI
JOIN AKUN A ON P.AKUN_WEBSITE = A.NAMA_AKUN;

INDEX:

CREATE INDEX CARI_STATUS ON TRANSAKSI(STATUS);

Cara Lihat:
SELECT INDEX FROM TRANSAKSI;

PROCEDURE:

DELIMITER $$

CREATE PROCEDURE INSERT_DATA (
    IN p_ID_PEMBELI VARCHAR(20),
    IN p_USERNAME VARCHAR(100),
    IN p_AKUN_WEBSITE VARCHAR(100),
    IN p_ID_TOKO VARCHAR(20),
    IN p_NAMA_GAME VARCHAR(100),
    IN p_PRODUK VARCHAR(100),
    IN p_HARGA INT,
    IN p_METODE_PEMBAYARAN VARCHAR(50),
    IN p_TANGGAL DATE,
    IN p_STATUS VARCHAR(20)
)
BEGIN
    INSERT IGNORE INTO PEMBELI (ID_PEMBELI, USERNAME, AKUN_WEBSITE)
    VALUES (p_ID_PEMBELI, p_USERNAME, p_AKUN_WEBSITE);

    INSERT IGNORE INTO TOKO (ID_TOKO, NAMA_GAME, PRODUK, HARGA)
    VALUES (p_ID_TOKO, p_NAMA_GAME, p_PRODUK, p_HARGA);

    INSERT INTO TRANSAKSI (
        ID_TOKO_TR, ID_PEMBELI_TR, PRODUK_TRANSAKSI, HARGA,
        METODE_PEMBAYARAN, WAKTU_TR, STATUS
    )
    VALUES (
        p_ID_TOKO, p_ID_PEMBELI, p_PRODUK, p_HARGA,
        p_METODE_PEMBAYARAN, p_TANGGAL, p_STATUS
    );
END$$

DELIMITER ;
